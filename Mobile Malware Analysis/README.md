# Mobile Malware Analysis

### An Unknown Land
I found the answers to these questions [here](https://www.retaildive.com/ex/mobilecommercedaily/a-brief-history-of-mobile-malware).
- What known as the first malware created to affect mobile devices? `Cabir`
- What technology does this worm used to multiply? `Bluetooth`
- What operating system did it infect? `Symbian`
- What message did it show on the screen of the infected mobile phone? `Caribe`

### Small size, a lot of destruction.
- What is the format of the file? `.apk`
- Decode the name of the sample.<br />
![image](https://github.com/user-attachments/assets/aa1bac31-5ac2-45f6-9c8b-5851a23769cc)<br />
`Malware`
- Which is the target platform? `Android`

### Digging Deeper
- What does Avast-Mobile can tell us about this software?<br />
![image](https://github.com/user-attachments/assets/bb5d58f2-7f15-45d9-ab40-0c3bed4b282f)<br />
`Android:Metasploit-G [PUP]`
- What program was used to create the malware? `Metasploit`
- What is the package name?<br />
Go to the "Details" section:<br />
![image](https://github.com/user-attachments/assets/da163d62-05b4-4eb3-a904-cb811c800dbd)<br />
`com.metasploit.stage`
- What is the SHA-1 signature? `74d442594acf11dc6e3492ffea5eb8956afd000d`
- What is the unique XML file?<br />
Go to the "Relations" section:<br />
![image](https://github.com/user-attachments/assets/95836091-4127-43b6-a551-46c806abe753)<br />
`AndroidManifest.xml`
- How many permissions are there inside? Click on it to analyze it: `22`
- Which permission allows the application to take pictures with the camera?<br />
![image](https://github.com/user-attachments/assets/50311f2f-5b62-4f6d-9c6c-90e025133240)<br />
`android.permission.CAMERA`
- What is the message left by the community? `THM{V1ru5-T0t4al-TWFsd2FyZS1BbmFseXNpcw}`

### MobSFing the sample.
- What is the programming language used to create the program? `java`
- How many signatures does the package has? `1`
- Application is signed with v1 signature scheme, what is it vulnerable to on Android <7.0?<br />
![image](https://github.com/user-attachments/assets/4a390cff-8e47-49de-accb-d1cb11d5a275)<br />
`Janus`
- What is the App name?<br />
![image](https://github.com/user-attachments/assets/08c42e25-b51e-4374-bc48-caef043a2ed2)<br />
`MainActivity`
- It looks like  there is a function calling for the package manager, so it can see all the installed applications. What function is that?<br />
Open the file `payload.java`: <br />
![image](https://github.com/user-attachments/assets/99a62b98-2ba9-4cb2-905b-299ea3b7c47a)<br />
`b.getPackageManager`
- The flag "android:allowBackup" allows the user to backup application data via USB debugging. It is recommended that this be set as "False", even if by default it is "True". What is the severity of this configuration?<br />
![image](https://github.com/user-attachments/assets/9e44acb9-34a6-4f2f-b06b-fab46dea5d22)<br />
`medium`

### It doesn't smell good!
- What is the SHA-256 hash of the file? `bd8cda80aaee3e4a17e9967a1c062ac5c8e4aefd7eaa3362f54044c2c94db52a`
- After finding the sample on VirusTotal, what does the "Avast" anti-virus engine recognizes it as? `Android:Obfus-BM [Trj]`
- With what we have, try to find out the name of the sample.<br />
![image](https://github.com/user-attachments/assets/f9ff2930-a1a9-483c-a276-3380af903616)<br />
`Pegasus`
- It seems like it is a very dangerous malware and has a big history of destruction. This became news for spying journalists, what year was that? `2017`
- What is the ID of the MITRE ATT&CK that is associated with our sample?<br />
![image](https://github.com/user-attachments/assets/650f9525-a0eb-448e-a97f-1d0f87b1db18)<br />
`s0316`
- What technique has the ability to exploit OS vulnerabilities to escalate privileges? `T1404`
- There is a permission that when accepted, allows the application to access the list of accounts in the Accounts Service. What is the status shown by MobSF regarding this permission. (android.permission.GET.ACCOUNTS)<br />
![image](https://github.com/user-attachments/assets/bcb3e367-50ae-4e33-b40d-9045652a1294)<br />
`dangerous`
- What org.eclipse.paho.client file refers to properties of Portuguese from Brazil (pt-br)?<br />
![image](https://github.com/user-attachments/assets/1e9fd8fd-4f2a-4598-a0cc-8f9d39851d1a)<br />
`org/eclipse/paho/client/mqttv3/internal/nls/messages_pt_BR.properties`
- The malware has a special appeal for its safety and its internal components, reducing the risk of compromise. It has a functionality for its cryptographic operations with the feature of a random bit generation service. How can it be identified?<br />
![image](https://github.com/user-attachments/assets/2ea32933-5757-4b10-9b5a-706edb08682d)<br />
`FCS_RBG_EXT.1.1`

